# æœåŠ¡å™¨ç›®å½•ç»“æ„è¯´æ˜

## ğŸ“ ç›®å½•ç»“æ„

```
server/
â”œâ”€â”€ index.js                    # ä¸»å…¥å£æ–‡ä»¶
â”œâ”€â”€ config/                     # é…ç½®æ¨¡å—
â”‚   â””â”€â”€ index.js               # é…ç½®ç®¡ç†
â”œâ”€â”€ routes/                     # è·¯ç”±æ¨¡å—
â”‚   â””â”€â”€ webhook.js             # Webhook è·¯ç”±å¤„ç†
â”œâ”€â”€ services/                   # ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”œâ”€â”€ aiCodeReviewer.js      # AI ä»£ç å®¡æŸ¥æœåŠ¡
â”‚   â”œâ”€â”€ aiApiService.js        # AI API è°ƒç”¨æœåŠ¡
â”‚   â”œâ”€â”€ githubAPI.js           # GitHub API æ“ä½œæœåŠ¡
â”‚   â”œâ”€â”€ gitlabAPI.js           # GitLab API æ“ä½œæœåŠ¡
â”‚   â”œâ”€â”€ config/                # æœåŠ¡é…ç½®
â”‚   â”‚   â””â”€â”€ aiReviewConfig.js  # AI å®¡æŸ¥é…ç½®
â”‚   â””â”€â”€ utils/                 # æœåŠ¡å·¥å…·ç±»
â”‚       â”œâ”€â”€ cacheManager.js    # ç¼“å­˜ç®¡ç†
â”‚       â”œâ”€â”€ codeProcessor.js   # ä»£ç å¤„ç†å·¥å…·
â”‚       â”œâ”€â”€ commentMatcher.js  # è¯„è®ºåŒ¹é…å·¥å…·
â”‚       â”œâ”€â”€ errorHandler.js    # é”™è¯¯å¤„ç†å·¥å…·
â”‚       â”œâ”€â”€ fileFilter.js      # æ–‡ä»¶è¿‡æ»¤å·¥å…·
â”‚       â””â”€â”€ promptGenerator.js # æç¤ºè¯ç”Ÿæˆå·¥å…·
â”œâ”€â”€ handlers/                   # äº‹ä»¶å¤„ç†å™¨
â”‚   â”œâ”€â”€ githubEventHandler.js  # GitHub äº‹ä»¶å¤„ç†
â”‚   â””â”€â”€ gitlabEventHandler.js  # GitLab äº‹ä»¶å¤„ç†
â”œâ”€â”€ utils/                      # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ helpers.js             # é€šç”¨è¾…åŠ©å‡½æ•°
â”‚   â””â”€â”€ logger.js              # æ—¥å¿—å·¥å…·
â””â”€â”€ README.md                  # æœ¬è¯´æ˜æ–‡ä»¶
```

## ğŸ”§ æ¨¡å—è¯´æ˜

### 1. **index.js** - ä¸»å…¥å£æ–‡ä»¶
- Express åº”ç”¨åˆå§‹åŒ–
- ä¸­é—´ä»¶é…ç½®
- è·¯ç”±æ³¨å†Œ
- æœåŠ¡å¯åŠ¨

### 2. **config/index.js** - é…ç½®ç®¡ç†
- ç¯å¢ƒå˜é‡é…ç½®
- æœåŠ¡é…ç½®ç®¡ç†
- é…ç½®éªŒè¯

### 3. **routes/webhook.js** - è·¯ç”±å±‚
- å¥åº·æ£€æŸ¥ç«¯ç‚¹
- GitHub/GitLab Webhook å…¥å£
- è¯·æ±‚å‚æ•°éªŒè¯
- é”™è¯¯å¤„ç†

### 4. **services/** - ä¸šåŠ¡æœåŠ¡å±‚

#### 4.1 æ ¸å¿ƒæœåŠ¡
- **aiCodeReviewer.js**: AI ä»£ç å®¡æŸ¥æ ¸å¿ƒæœåŠ¡
- **aiApiService.js**: AI API è°ƒç”¨å°è£…æœåŠ¡

#### 4.2 API æœåŠ¡
- **githubAPI.js**: GitHub API æ“ä½œæœåŠ¡
- **gitlabAPI.js**: GitLab API æ“ä½œæœåŠ¡

#### 4.3 é…ç½®æœåŠ¡
- **config/aiReviewConfig.js**: AI å®¡æŸ¥é…ç½®ï¼ˆåˆ†ç»„è§„åˆ™ã€è¿‡æ»¤è§„åˆ™ç­‰ï¼‰

#### 4.4 å·¥å…·æœåŠ¡
- **utils/cacheManager.js**: ç¼“å­˜ç®¡ç†å·¥å…·
- **utils/codeProcessor.js**: ä»£ç å¤„ç†å·¥å…·ï¼ˆåˆ†ç»„ã€è¿‡æ»¤ã€è§£æï¼‰
- **utils/commentMatcher.js**: è¯„è®ºåŒ¹é…å·¥å…·
- **utils/errorHandler.js**: é”™è¯¯å¤„ç†å·¥å…·
- **utils/fileFilter.js**: æ–‡ä»¶è¿‡æ»¤å·¥å…·
- **utils/promptGenerator.js**: æç¤ºè¯ç”Ÿæˆå·¥å…·

### 5. **handlers/** - äº‹ä»¶å¤„ç†å±‚
- **githubEventHandler.js**: GitHub äº‹ä»¶å¤„ç†é€»è¾‘
- **gitlabEventHandler.js**: GitLab äº‹ä»¶å¤„ç†é€»è¾‘
- æ”¯æŒ Push äº‹ä»¶å’Œ Merge Request äº‹ä»¶
- ä¸šåŠ¡æµç¨‹ç¼–æ’

### 6. **utils/** - å·¥å…·å‡½æ•°
- **helpers.js**: é€šç”¨è¾…åŠ©å‡½æ•°
- **logger.js**: ç»“æ„åŒ–æ—¥å¿—è®°å½•å·¥å…·

## ğŸš€ å¯åŠ¨æ–¹å¼

```bash
# å¼€å‘æ¨¡å¼
npm run dev

# ç”Ÿäº§æ¨¡å¼
npm start
```

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### AI ä»£ç å®¡æŸ¥æµç¨‹
1. **ä»£ç æ¥æ”¶**: é€šè¿‡ Webhook æ¥æ”¶ GitHub/GitLab äº‹ä»¶
2. **æ–‡ä»¶è¿‡æ»¤**: æ ¹æ®æ–‡ä»¶ç±»å‹å’Œè§„åˆ™è¿‡æ»¤éœ€è¦å®¡æŸ¥çš„æ–‡ä»¶
3. **ä»£ç åˆ†ç»„**: ä½¿ç”¨æ™ºèƒ½åˆ†ç»„ç®—æ³•å°†ä»£ç å˜æ›´åˆ†ç»„
4. **AI å®¡æŸ¥**: è°ƒç”¨ AI API è¿›è¡Œä»£ç è´¨é‡å®¡æŸ¥
5. **ç»“æœå¤„ç†**: å°†å®¡æŸ¥ç»“æœå‘å¸ƒåˆ°å¯¹åº”çš„ä»£ç å¹³å°

### æ™ºèƒ½åˆ†ç»„ç­–ç•¥
- **è¡Œå·è¿ç»­æ€§**: è¿ç»­è¡Œå·è‡ªåŠ¨åˆ†ç»„
- **è¯­ä¹‰è¾¹ç•Œ**: åœ¨å‡½æ•°ã€ç±»ã€æ³¨é‡Šå—è¾¹ç•Œæ™ºèƒ½åˆ†ç»„
- **æ€§èƒ½ä¼˜åŒ–**: æ§åˆ¶æ¯ç»„æœ€å¤§è¡Œæ•°ï¼ˆé»˜è®¤40è¡Œï¼‰
- **é¢„è¿‡æ»¤**: è·³è¿‡æ˜æ˜¾ä¸éœ€è¦å®¡æŸ¥çš„ä»£ç 

### æ”¯æŒçš„å¹³å°
- **GitHub**: æ”¯æŒ Push å’Œ Pull Request äº‹ä»¶
- **GitLab**: æ”¯æŒ Push å’Œ Merge Request äº‹ä»¶

## ğŸ“ æ‰©å±•è¯´æ˜

- æ–°å¢åŠŸèƒ½æ—¶ï¼Œåœ¨å¯¹åº”æ¨¡å—ä¸­æ·»åŠ 
- æ–°å¢è·¯ç”±æ—¶ï¼Œåœ¨ `routes/` ç›®å½•ä¸‹åˆ›å»º
- æ–°å¢æœåŠ¡æ—¶ï¼Œåœ¨ `services/` ç›®å½•ä¸‹åˆ›å»º
- æ–°å¢äº‹ä»¶ç±»å‹æ—¶ï¼Œåœ¨ `handlers/` ç›®å½•ä¸‹æ‰©å±•
- æ–°å¢å·¥å…·å‡½æ•°æ—¶ï¼Œåœ¨ `utils/` ç›®å½•ä¸‹åˆ›å»º
- ä¿®æ”¹åˆ†ç»„è§„åˆ™æ—¶ï¼Œæ›´æ–° `services/config/aiReviewConfig.js`
- ä¿®æ”¹æç¤ºè¯æ—¶ï¼Œæ›´æ–° `services/utils/promptGenerator.js`
